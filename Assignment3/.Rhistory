cov.WK <- cov(Wrist.diam, Knee.diam)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2])
plot(Wrist.diam, Knee.diam, title="Wrist vs Knee diameter", asp = 1)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
cov.WK <- cov(Wrist.diam, Knee.diam)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", asp = 1)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
cov.WK <- cov(Wrist.diam, Knee.diam)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter")
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
cov.WK <- cov(Wrist.diam, Knee.diam)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
cov.WK <- cov(Wrist.diam, Knee.diam)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
cov.WK <- cov(Wrist.diam, Knee.diam)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
install.package("SIBER")
install.packages("SIBER")
library(SIBER)
WK <- data.frame(Wrist.diam, Knee.diam)
inside <- pointsToEllipsoid(WK, cov.WK, mean.WK)
cov.WK
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
cov.WK
inside <- pointsToEllipsoid(WK, cov.WK, mean.WK)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
inside <- pointsToEllipsoid(WK, cov.WK, mean.WK)
points(inside, pch=16, col="green", cex0.5)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
inside <- pointsToEllipsoid(WK, cov.WK, mean.WK)
points(inside, pch=16, col="green", cex=0.5)
inside
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
inside <- pointsToEllipsoid(WK, cov.WK, mean.WK)
points(inside[,1], inside[,2], pch=16, col="green", cex=0.5)
plot(inside[,1], inside[,2], pch=16, col="green", cex=0.5)
inside <- ellipseInOut(Z)
Z <- pointsToEllipsoid(WK, cov.WK, mean.WK)
inside <- ellipseInOut(Z)
plot(inside[,1], inside[,2], pch=16, col="green", cex=0.5)
inside
plot(WK[inside], pch=16, col="green", cex=0.5)
plot(WK[inside,], pch=16, col="green", cex=0.5)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
Z <- pointsToEllipsoid(WK, cov.WK, mean.WK)
inside <- ellipseInOut(Z)
plot(WK[inside,], pch=16, col="green", cex=0.5)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
Z <- pointsToEllipsoid(WK, cov.WK, mean.WK)
inside <- ellipseInOut(Z)
points(WK[inside,], pch=16, col="green", cex=0.5)
sum(inside)/length(inside)
inside
WK.values
WK.value
values(WK)
as.matrix(WK)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
WK <- as.matrix(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
Z <- pointsToEllipsoid(WK, cov.WK, mean.WK)
inside <- ellipseInOut(Z)
points(WK[inside,], pch=16, col="green", cex=0.5)
cov.WK
cov.WK <- as.matrix(cov(WK))
cov.WK
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
Z <- pointsToEllipsoid(WK, cov.WK, mean.WK)
inside <- ellipseInOut(Z)
points(WK[inside,], pch=16, col="green", cex=0.5)
sum(inside)/length(inside)
inside
sum(inside)
length(inside)
sum(inside)/length(inside)
sum(inside)/length(inside) * 100
length(inside)-sum(inside)
100 - sum(inside)/length(inside) * 100
100 - sum(inside)/length(inside) * 100
sum(inside)
detach(dd)
dd <- read.table("http://www-eio.upc.es/%7Ejan/Data/MVA/cmc.dat", header = T, sep=',')
attach(dd)
head(dd)
summary(dd)
Age < 5 || Age > 70
WifeEduc!=1 && WifeEduc!=2 && WifeEduc!=3 && WifeEduc!=4
HusbEduc!=1 && HusbEduc!=2 && HusbEduc!=3 && HusbEduc!=4
sum(Childs>4)
sum(Childs==16)
Rel!=0 && Rel!=1
Work!=0 && Work!=1
Occup!=1 && Occup!=2 && Occup!=3 && Occup!=4
Standard!=1 && Standard!=2 && Standard!=3 && Standard!=4
Media!=0 && Media!=1
Method!=1 && Method!=2 && Method!=3
dd[is.na(dd)]
dd$Method[Method==1] <- "3none"
dd$Method[Method==2] <- "1long-term"
dd$Method[Method==3] <- "2short-term"
dd$Method <- as.factor(dd$Method)
dd$WifeEduc[WifeEduc==1] <- "4low"
dd$WifeEduc[WifeEduc==2] <- "3medium-low"
dd$WifeEduc[WifeEduc==3] <- "2medium-high"
dd$WifeEduc[WifeEduc==4] <- "1high"
dd$WifeEduc <- as.factor(dd$WifeEduc)
detach(dd)
attach(dd)
(cont <- table(Method, WifeEduc))
chi.test <- chisq.test(Method, WifeEduc)
chi.test$statistic
chi.test$p.value
# Columna
(c <- apply(cont, 2, sum))
# Fila
(r <- apply(cont, 1, sum))
Dr <- diag(r)
Dc <- diag(c)
(R <- solve(Dr)%*%cont)
(C <- t(solve(Dc)%*%t(cont)))
library(ca)
resultats <- ca(cont)
summary(resultats)
plot(resultats, map="rowprincipal")
dd$Age <- cut(dd$Age, breaks=4)
detach(dd)
attach(dd)
table(Age)
library(tidyr)
dd <- unite(dd, AgeRel, c(Age, Rel), remove=F)
detach(dd)
attach(dd)
table(AgeRel)
(cont2 <- table(AgeRel, Method))
res <- ca(cont2)
plot(res, map="rowgreen")
out <- mjca(dd[,c("WifeEduc", "Method", "AgeRel")], lambda="indicator")
summary(out)
out$inertia.t
plot(out, main="MCA biplot of Indicator matrix")
plot(out, main="MCA biplot of Indicator matrix with data")
points(out$rowpcoord[,1], out$rowpcoord[,2])
dim(out$rowpcoord)
out2 <- mjca(dd[,c("WifeEduc", "Method", "AgeRel")], lambda="Burt")
summary(out2)
plot(out2, main="MCA biplot of Burt matrix with data")
points(out2$rowpcoord[,1], out$rowpcoord[,2])
esq <- read.table("http://www-eio.upc.es/%7Ejan/Data/MVA/body.dat")
esq <- esq[,c(1:9,25)]
colnames(esq) <- c("Biacromial.diam", "Biiliac.diam", "Bitrochanteric.diam", "Chest.depth", "Chest.diam", "Elbow.diam", "Wrist.diam", "Knee.diam", "Ankle.diam", "Gender")
esq$Gender <- as.factor(esq$Gender)
head(esq)
attach(esq)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
Z <- pointsToEllipsoid(WK, cov.WK, mean.WK)
inside <- ellipseInOut(Z)
points(WK[inside,], pch=16, col="green", cex=0.5)
length(inside)-sum(inside)
100 - sum(inside)/length(inside) * 100
detach(dd)
detach(esq)
detach(esq)
dd <- read.table("http://www-eio.upc.es/%7Ejan/Data/MVA/cmc.dat", header = T, sep=',')
attach(dd)
head(dd)
summary(dd)
Age < 5 || Age > 70
WifeEduc!=1 && WifeEduc!=2 && WifeEduc!=3 && WifeEduc!=4
HusbEduc!=1 && HusbEduc!=2 && HusbEduc!=3 && HusbEduc!=4
sum(Childs>4)
sum(Childs==16)
Rel!=0 && Rel!=1
Work!=0 && Work!=1
Occup!=1 && Occup!=2 && Occup!=3 && Occup!=4
Standard!=1 && Standard!=2 && Standard!=3 && Standard!=4
Media!=0 && Media!=1
Method!=1 && Method!=2 && Method!=3
dd[is.na(dd)]
dd$Method[Method==1] <- "3none"
dd$Method[Method==2] <- "1long-term"
dd$Method[Method==3] <- "2short-term"
dd$Method <- as.factor(dd$Method)
dd$WifeEduc[WifeEduc==1] <- "4low"
dd$WifeEduc[WifeEduc==2] <- "3medium-low"
dd$WifeEduc[WifeEduc==3] <- "2medium-high"
dd$WifeEduc[WifeEduc==4] <- "1high"
dd$WifeEduc <- as.factor(dd$WifeEduc)
detach(dd)
attach(dd)
(cont <- table(Method, WifeEduc))
chi.test <- chisq.test(Method, WifeEduc)
chi.test$statistic
chi.test$p.value
# Columna
(c <- apply(cont, 2, sum))
# Fila
(r <- apply(cont, 1, sum))
Dr <- diag(r)
Dc <- diag(c)
(R <- solve(Dr)%*%cont)
(C <- t(solve(Dc)%*%t(cont)))
library(ca)
resultats <- ca(cont)
summary(resultats)
plot(resultats, map="rowprincipal")
dd$Age <- cut(dd$Age, breaks=4)
detach(dd)
attach(dd)
table(Age)
library(tidyr)
dd <- unite(dd, AgeRel, c(Age, Rel), remove=F)
detach(dd)
attach(dd)
table(AgeRel)
(cont2 <- table(AgeRel, Method))
res <- ca(cont2)
plot(res, map="rowgreen")
out <- mjca(dd[,c("WifeEduc", "Method", "AgeRel")], lambda="indicator")
summary(out)
out$inertia.t
plot(out, main="MCA biplot of Indicator matrix")
plot(out, main="MCA biplot of Indicator matrix with data")
points(out$rowpcoord[,1], out$rowpcoord[,2])
dim(out$rowpcoord)
out2 <- mjca(dd[,c("WifeEduc", "Method", "AgeRel")], lambda="Burt")
summary(out2)
plot(out2, main="MCA biplot of Burt matrix with data")
points(out2$rowpcoord[,1], out$rowpcoord[,2])
detach(dd)
esq <- read.table("http://www-eio.upc.es/%7Ejan/Data/MVA/body.dat")
esq <- esq[,c(1:9,25)]
colnames(esq) <- c("Biacromial.diam", "Biiliac.diam", "Bitrochanteric.diam", "Chest.depth", "Chest.diam", "Elbow.diam", "Wrist.diam", "Knee.diam", "Ankle.diam", "Gender")
esq$Gender <- as.factor(esq$Gender)
head(esq)
attach(esq)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
Z <- pointsToEllipsoid(WK, cov.WK, mean.WK)
inside <- ellipseInOut(Z)
points(WK[inside,], pch=16, col="green", cex=0.5)
length(inside)-sum(inside)
100 - sum(inside)/length(inside) * 100
detach(esq)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
attach(esq)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
Z <- pointsToEllipsoid(WK, cov.WK, mean.WK)
inside <- ellipseInOut(Z)
points(WK[inside,], pch=16, col="green", cex=0.5)
0.05 * length(inside)
# Método 2 (Estadístico)
(scaled.points <- scale(WK))
qnorm(0)
pnorm(0)
library(mvtnorm)
pmvnorm(c(0,0), sigma=matrix(c(1,0,0,1), ncol=2))
dmvnorm(c(0,0), sigma=matrix(c(1,0,0,1), ncol=2))
WK[,inside[1]]
inside[2]
WK[inside[1],]
WK
WK[1,1]
WK[c(TRUE,F),1]
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
WK[inside[1],]
# Método 1 (fácil)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
Z <- pointsToEllipsoid(WK, cov.WK, mean.WK)
inside <- ellipseInOut(Z)
points(WK[inside,], pch=16, col="green", cex=0.5)
WK[inside]
WK[inside,]
inside
contour.WK[1]
dmvnorm(contour.WK, mean=mean.WK, sigma=cov.WK, ncol=2))
dmvnorm(contour.WK, mean=mean.WK, sigma=cov.WK, ncol=2)
dmvnorm(contour.WK, mean=mean.WK, sigma=cov.WK)
# Método 2 (Estadístico)
library(mvtnorm)
limit <- dmvnorm(contour.WK[1], mean=mean.WK, sigma=cov.WK)
mean.WK
contour.WK
cov.WK
limit <- dmvnorm(contour.WK[1], mean=mean.WK, sigma=cov.WK)
contout.WK[1]
contour.WK[1]
contour.WK[1,]
# Método 2 (Estadístico)
library(mvtnorm)
limit <- dmvnorm(contour.WK[1,], mean=mean.WK, sigma=cov.WK)
outside <- dmvnorm(WK, mean=mean.WK, sigma=cov.WK) < limit
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
lines(contour.WK[,1], contour.WK[,2], col = "red")
points(WK[outside,], pch=16, col="yellow", cex=0.5)
# Método 2 (Estadístico)
library(mvtnorm)
limit <- dmvnorm(contour.WK[1,], mean=mean.WK, sigma=cov.WK)
outside <- dmvnorm(WK, mean=mean.WK, sigma=cov.WK) < limit
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
lines(contour.WK[,1], contour.WK[,2], col = "red")
points(WK[outside,], pch=16, col="brown", cex=0.5)
# Método 2 (Estadístico)
library(mvtnorm)
limit <- dmvnorm(contour.WK[1,], mean=mean.WK, sigma=cov.WK)
outside <- dmvnorm(WK, mean=mean.WK, sigma=cov.WK) < limit
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
lines(contour.WK[,1], contour.WK[,2], col = "red")
points(WK[outside,], pch=16, col="deeppink", cex=0.5)
# Método 2 (Estadístico)
library(mvtnorm)
limit <- dmvnorm(contour.WK[1,], mean=mean.WK, sigma=cov.WK)
outside <- dmvnorm(WK, mean=mean.WK, sigma=cov.WK) < limit
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
lines(contour.WK[,1], contour.WK[,2], col = "red")
points(WK[outside,], pch=16, col="deeppink", cex=0.7)
detach(esq)
library(dplyr)
esq.f <- filter(esq, Gender==0)
attach(esq.f)
pairs()
pairs(esq.f)
pairs(esq.f[,-10])
detach(esq.f)
esq.f.centre <- as.matrix(scale(esq.f))
scale(esq.f)
esq.f
scale(as.matrix(esq.f))
esq.f <- esq.f[,-10]
pairs(esq.f)
esq.f.centre <- as.matrix(scale(esq.f))
esq.f.centre <- as.matrix(scale(esq.f))
esq.f.cov <- as.matrix(cov(esq.f))
esq.f.cov.inv <- solve(esq.f.cov)
esq.f.mat <- as.matrix(esq.f)
esq.f.mean <- as.matrix(apply(esq.f, 2, mean)
(esq.f.dist <- t(esq.f.mat - esq.f.mean) %*% esq.f.cov.inv %*% (esq.f.mat - esq.f.mean))
esq.f.centre <- as.matrix(scale(esq.f))
esq.f.cov <- as.matrix(cov(esq.f))
esq.f.cov.inv <- solve(esq.f.cov)
esq.f.mat <- as.matrix(esq.f)
esq.f.mean <- as.matrix(apply(esq.f, 2, mean))
(esq.f.dist <- t(esq.f.mat - esq.f.mean) %*% esq.f.cov.inv %*% (esq.f.mat - esq.f.mean))
esq.f.cov
esq.f.mean
esq.f.mat
esq.f.mat - esq.f.mean
dim(esq.f.mat)
esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])
esq.f.centre <- as.matrix(scale(esq.f))
esq.f.cov <- as.matrix(cov(esq.f))
esq.f.cov.inv <- solve(esq.f.cov)
esq.f.mat <- as.matrix(esq.f)
esq.f.mean <- as.matrix(apply(esq.f, 2, mean))
(esq.f.dist <- t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])) %*% esq.f.cov.inv %*% (esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])))
esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])
dim(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))
dim(esq.f.cov.inv)
esq.f.centre <- as.matrix(scale(esq.f))
esq.f.cov <- as.matrix(cov(esq.f))
esq.f.cov.inv <- solve(esq.f.cov)
esq.f.mat <- as.matrix(esq.f)
esq.f.mean <- as.matrix(apply(esq.f, 2, mean))
(esq.f.dist <- (esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])) %*% esq.f.cov.inv %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])))
esq.f.centre <- as.matrix(scale(esq.f))
esq.f.cov <- as.matrix(cov(esq.f))
esq.f.cov.inv <- solve(esq.f.cov)
esq.f.mat <- as.matrix(esq.f)
esq.f.mean <- as.matrix(apply(esq.f, 2, mean))
esq.f.dist.sq <- (esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])) %*% esq.f.cov.inv %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))
esq.f.centre <- as.matrix(scale(esq.f))
esq.f.cov <- as.matrix(cov(esq.f))
esq.f.cov.inv <- solve(esq.f.cov)
esq.f.mat <- as.matrix(esq.f)
esq.f.mean <- as.matrix(apply(esq.f, 2, mean))
esq.f.dist.sq <- (esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])) %*% esq.f.cov.inv %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))
sort(esq.f.dist.sq)
(esq.f.dist.sq.ord <- sort(esq.f.dist.sq))
esq.f.cov.inv
det(esq.f.cov.inv)
eig(esq.f.cov.inv)
svd(esq.f.cov.inv)
dim(esq.f.mean)
c(1, 2,3,4,5,6,7,8,9) %*% esq.f.cov.inv
c(1, 2,3,4,5,6,7,8,9) %*% esq.f.cov.inv t(c(1, 2,3,4,5,6,7,8,9))
c(1, 2,3,4,5,6,7,8,9) %*% esq.f.cov.inv %*% t(c(1, 2,3,4,5,6,7,8,9))
esq.f.cov.inv %*% t(c(1, 2,3,4,5,6,7,8,9))
t(c(1, 2,3,4,5,6,7,8,9))
(c(1, 2,3,4,5,6,7,8,9))
(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))
t((esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])))
head(t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])))
esq.f.cov.inv %*% (esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))
esq.f.cov.inv %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))
(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])) %*% esq.f.cov.inv
((esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])) %*% esq.f.cov.inv) %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))
c(1,2,3,4,5,6,7,8,9) %*% esq.f.cov.inv %*% t(t(c(1,2,3,4,5,6,7,8,9)))
((esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])[1,]) %*% esq.f.cov.inv) %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[,1]
((esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[1,] %*% esq.f.cov.inv) %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[,1]
((esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[i,] %*% esq.f.cov.inv) %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[,i]
i <- 2
((esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[i,] %*% esq.f.cov.inv) %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[,i]
i <- 3
((esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[i,] %*% esq.f.cov.inv) %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[,i]
i <- 40
((esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[i,] %*% esq.f.cov.inv) %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[,i]
i <- 150
((esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[i,] %*% esq.f.cov.inv) %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1]))[,i]
(esq.f.dist.sq.ord <- sort(diag(esq.f.dist.sq)))
esq.f.centre <- as.matrix(scale(esq.f))
esq.f.cov <- as.matrix(cov(esq.f))
esq.f.cov.inv <- solve(esq.f.cov)
esq.f.mat <- as.matrix(esq.f)
esq.f.mean <- as.matrix(apply(esq.f, 2, mean))
esq.f.dist.sq <- diag((esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])) %*% esq.f.cov.inv %*% t(esq.f.mat - rep(esq.f.mean, dim(esq.f.mat)[1])))
(esq.f.dist.sq.ord <- sort(esq.f.dist.sq))
