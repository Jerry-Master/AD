m2 <- colMeans(esq.m)
S1 <- cov(esq.f)
S2 <- cov(esq.m)
n1 <- dim(esq.f)[1]
n2 <- dim(esq.m)[1]
(T2 <- (m1-m2)%*%solve(S1/50+S2/50)%*%(m1-m2))
qchisq(0.95,2)
install.packages("biotools")
m1 <- colMeans(esq.f)
m2 <- colMeans(esq.m)
S1 <- cov(esq.f)
S2 <- cov(esq.m)
n1 <- dim(esq.f)[1]
n2 <- dim(esq.m)[1]
(T2 <- (m1-m2)%*%solve(S1/50+S2/50)%*%(m1-m2))
qchisq(0.95,2)
library(biotools)
install.packages("biotools")
library(biotools)
capabilities("tcltk")
install.packages("rpanel", dependencies = TRUE)
install.packages("classInt", dependencies = TRUE)
install.packages("SpatialEpi", dependencies = TRUE)
install.packages("biotools", dependencies = TRUE)
install.packages("rpanel", dependencies = TRUE)
install.packages("biotools", dependencies = TRUE)
install.packages("rpanel", dependencies = TRUE)
t.test(esq.f[,1],esq.m[,1])
S1
S2-S1
test.marginal <- t.test(esq.f[,1],esq.m[,1], var.equal=F)
for (i in 1:10){
test.marginal <- t.test(esq.f[,i],esq.m[,i], var.equal=F)
if (test.marginal$p.value < 0.001) {
plot(colnames(esq)[i])
}
}
for (i in 1:10){
test.marginal <- t.test(esq.f[,i],esq.m[,i], var.equal=F)
if (test.marginal$p.value < 0.001) {
print(colnames(esq)[i])
}
}
for (i in 1:9){
test.marginal <- t.test(esq.f[,i],esq.m[,i], var.equal=F)
if (test.marginal$p.value < 0.001) {
print(colnames(esq)[i])
}
}
for (i in 1:9){
test.marginal <- t.test(esq.f[,i],esq.m[,i], var.equal=F)
if (test.marginal$p.value < 0.001) {
print(colnames(esq)[i])
} else {
print(paste("no difference in", colnames(esq)[i]))
}
}
for (i in 1:9){
test.marginal <- t.test(esq.f[,i],esq.m[,i], var.equal=F)
if (test.marginal$p.value < 0.001) {
print(paste("Difference in", colnames(esq)[i]))
} else {
print(paste("No difference in", colnames(esq)[i]))
}
}
boxplot(esq)
m1 <- colMeans(esq.f)
m2 <- colMeans(esq.m)
S1 <- cov(esq.f)
S2 <- cov(esq.m)
n1 <- dim(esq.f)[1]
n2 <- dim(esq.m)[1]
(T2 <- (m1-m2)%*%solve(S1/50+S2/50)%*%(m1-m2))
qchisq(0.95,2)
par(mfrow=c(3,3))
for (i in 1:9){
boxplot(esq[i])
}
boxplot(esq.f, esq.m)
boxplot(esq.f[1], esq.m[1])
boxplot(data.frame(a=esq.f[1], b=esq.m[1])
boxplot(data.frame(a=esq.f[1], b=esq.m[1]))
boxplot(data.frame(a=esq.f[,1], b=esq.m[,1]))
boxplot(esq.f[,1], esq.m[,1])
par(mfrow=c(3,3))
for (i in 1:9){
boxplot(esq.f[,i], esq.m[,i])
}
par(mfrow=c(3,3))
for (i in 1:9){
boxplot(esq.f[,i], esq.m[,i])
}
par(mfrow=c(3,3))
for (i in 1:9){
boxplot(esq.f[,i], esq.m[,i], names=c("Female","Male"))
}
par(mfrow=c(3,3))
for (i in 1:9){
boxplot(esq.f[,i], esq.m[,i], names=c("Female","Male"))
}
for (i in 1:9){
boxplot(esq.f[,i], esq.m[,i], names=c("Female","Male"))
}
for (i in 1:9){
boxplot(esq.f[,i], esq.m[,i], names=c("Female","Male"), main=colnames(esq)[i])
}
library("FactoMineR")
library("ca")
library("MASS")
X <- read.table("http://www-eio.upc.es/~jan/Data/MVA/cmc.dat", header = T, sep = ",")
head(X)
for (i in 1:ncol(X)) {
print(range(X[,i]))
}
X$Method <- factor(X$Method, levels = c(1, 2, 3), labels = c("none", "long-term", "mid-term"))
X$WifeEduc <- factor(X$WifeEduc, levels = c(1, 2, 3, 4), labels = c("low", "prim", "mid", "high"))
(taula <- table(X$Method, X$WifeEduc))
chisq.test(taula)
out <- ca(taula)
(r <- out$rowmass)
(c <- out$colmass)
P <- as.matrix(taula)
P <- P/sum(P) # matriu de probabilitats
(R <- diag(1/r)%*%P)
(C <- diag(1/c)%*%t(P))
resultats <- ca(taula)
summary(resultats)
plot(resultats, map = "rowprincipal")
X$Age <- as.factor(cut(X$Age, breaks = 4))
table(X$Age)
X$AgeRel <- with(X, interaction(Age, Rel))
table(X$AgeRel)/nrow(X)
(taula2 <- table(X$Method, X$AgeRel))
summary(resultats2 <- ca(taula2))
plot(resultats2, map = "rowgreen")
tmult <- table(X$Method, X$WifeEduc, X$AgeRel)
summary(acmult <- mjca(tmult, lambda = "indicator"))
plot(acmult)
plot(acmult)
points(acmult$rowpcoord)
summary(B <- mjca(tmult, lambda = "Burt"))
plot(B)
library("ellipse")
library("ICSNP")
dd <- read.table("http://www-eio.upc.es/~jan/Data/MVA/body.dat")[,c(1:9, 25)]
names(dd) <- c("Biacromial", "Biilical", "Bitrochanteric", "Chest_depth", "Chest_diam", "Elbow", "Wrist", "Knee", "Ankle", "Gender")
dd$Gender <- factor(dd$Gender, levels = c(0, 1), labels = c("female", "male"))
WK <- data.frame(dd$Wrist, dd$Knee)
plot(WK, pch = 3)
Z <- ellipse(cov(WK), level = 0.95, centre = colMeans(WK))
points(Z, type = "l", col = "red")
print(exp <- nrow(dd)*5/100)
df <- dd[dd$Gender == "female",1:9]
pairs(df, pch = 20)
chisq_plot <- function(X){
M <- as.matrix(scale(X, center = T, scale = F))
S <- solve(cov(X))
v <- c()
for (i in 1:nrow(M)) {
aux <- t(M[i,])%*%S%*%M[i,]
v <- c(v, aux)
}
sort(v)
}
(chp <- chisq_plot(df))
rang <- c()
n <- length(chp)
for (i in 1:n){
rang <- c(rang, (i-1/2)/n)
}
(q <- qchisq(rang, 9))
plot(q, chp)
abline(0,1, col = "red")
par(mfrow = c(3, 3))
for (i in 1:9) {
qqnorm(df[,i])
}
dh <- dd[dd$Gender == "male",1:9]
par(mfrow=c(3,3))
for (i in 1:9){
qqnorm(dh[,i])
}
HotellingsT2(df, dh, test = "f")
HotellingsT2(df, dh, test = "chi")
t.test(df$Biacromial, dh$Biacromial, conf.level = 0.999)
t.test(df$Biilical, dh$Biilical, conf.level = 0.999)
t.test(df$Bitrochanteric, dh$Bitrochanteric, conf.level = 0.999)
t.test(df$Chest_depth, dh$Chest_depth, conf.level = 0.999)
t.test(df$Chest_diam, dh$Chest_diam, conf.level = 0.999)
t.test(df$Elbow, dh$Elbow, conf.level = 0.999)
t.test(df$Wrist, dh$Wrist, conf.level = 0.999)
t.test(df$Knee, dh$Knee, conf.level = 0.999)
t.test(df$Ankle, dh$Ankle, conf.level = 0.999)
par(mfrow=c(3,3))
boxplot(dd$Biacromial~dd$Gender)
boxplot(dd$Biilical~dd$Gender)
boxplot(dd$Bitrochanteric~dd$Gender)
boxplot(dd$Chest_depth~dd$Gender)
boxplot(dd$Chest_diam~dd$Gender)
boxplot(dd$Elbow~dd$Gender)
boxplot(dd$Wrist~dd$Gender)
boxplot(dd$Knee~dd$Gender)
boxplot(dd$Ankle~dd$Gender)
apply(P, 2, sum)
dist(marg, R)
dist(rbind(marg, R[1,]))
marg <- apply(P, 2, sum)
dist(rbind(marg, R[1,]))
marg <- apply(P, 2, sum)
dist(rbind(marg, R[2,]))
marg <- apply(P, 2, sum)
dist(rbind(marg, R[3,]))
marg <- apply(P, 2, sum)
dist(rbind(marg, R[4,]))
marg <- apply(P, 2, sum)
dist(rbind(marg, R[3,]))
marg <- apply(P, 2, sum)
dist(rbind(marg, R[1,]))
marg <- apply(P, 2, sum)
dist(rbind(marg, R[3,]))
marg <- apply(P, 2, sum)
dist(rbind(marg, R[1,]))
marg <- apply(P, 2, sum)
dist(rbind(marg, R[3,]))
(marg <- apply(P, 2, sum))
dist(rbind(marg, R[3,]))
(marg <- apply(P, 2, sum))
dist(rbind(marg, R[3,]))
Dist(rbind(marg, R[3,]))
dist(rbind(marg, R[3,]))
(marg <- apply(P, 2, sum))
dist(rbind(marg, R[3,]))
(marg <- apply(P, 2, sum))
dist(rbind(marg, R[3,]))
sum(P)
(marg <- apply(P, 2, sum))
dist(rbind(marg, R[3,]))
sum(table(X$AgeRel)/nrow(X))
table(X$AgeRel)/nrow(X)
head(X)
tmult <- table(X[,"Method", "WifeEduc", "AgeRel"])
tmult <- table(X[,c("Method", "WifeEduc", "AgeRel")])
summary(acmult <- mjca(tmult, lambda = "indicator"))
plot(acmult)
summary(B <- mjca(tmult, lambda = "Burt"))
plot(B)
points(B$rowpcoord[,1], B$rowpcoord[,2])
#library("FactoMineR")
library("ca")
library("MASS")
X <- read.table("http://www-eio.upc.es/~jan/Data/MVA/cmc.dat", header = T, sep = ",")
head(X)
for (i in 1:ncol(X)) {
print(range(X[,i]))
}
X$Method <- factor(X$Method, levels = c(1, 2, 3), labels = c("none", "long-term", "mid-term"))
X$WifeEduc <- factor(X$WifeEduc, levels = c(1, 2, 3, 4), labels = c("low", "prim", "mid", "high"))
(taula <- table(X$Method, X$WifeEduc))
chisq.test(taula)
out <- ca(taula)
(r <- out$rowmass)
(c <- out$colmass)
P <- as.matrix(taula)
P <- P/sum(P) # matriu de probabilitats
(R <- diag(1/r)%*%P)
(C <- diag(1/c)%*%t(P))
(marg <- apply(P, 2, sum))
dist(rbind(marg, R[3,]))
resultats <- ca(taula)
summary(resultats)
plot(resultats, map = "rowprincipal")
X$Age <- as.factor(cut(X$Age, breaks = 4))
table(X$Age)
X$AgeRel <- with(X, interaction(Age, Rel))
table(X$AgeRel)/nrow(X)
(taula2 <- table(X$Method, X$AgeRel))
summary(resultats2 <- ca(taula2))
plot(resultats2, map = "rowgreen")
tmult <- table(X[,c("Method", "WifeEduc", "AgeRel")])
summary(acmult <- mjca(tmult, lambda = "indicator"))
head(X)
plot(acmult)
plot(acmult)
points(acmult$rowpcoord)
summary(B <- mjca(tmult, lambda = "Burt"))
plot(B)
points(B$rowpcoord[,1], B$rowpcoord[,2])
library("ellipse")
library("ICSNP")
dd <- read.table("http://www-eio.upc.es/~jan/Data/MVA/body.dat")[,c(1:9, 25)]
names(dd) <- c("Biacromial", "Biilical", "Bitrochanteric", "Chest_depth", "Chest_diam", "Elbow", "Wrist", "Knee", "Ankle", "Gender")
dd$Gender <- factor(dd$Gender, levels = c(0, 1), labels = c("female", "male"))
WK <- data.frame(dd$Wrist, dd$Knee)
plot(WK, pch = 3)
Z <- ellipse(cov(WK), level = 0.95, centre = colMeans(WK))
points(Z, type = "l", col = "red")
print(exp <- nrow(dd)*5/100)
df <- dd[dd$Gender == "female",1:9]
pairs(df, pch = 20)
chisq_plot <- function(X){
M <- as.matrix(scale(X, center = T, scale = F))
S <- solve(cov(X))
v <- c()
for (i in 1:nrow(M)) {
aux <- t(M[i,])%*%S%*%M[i,]
v <- c(v, aux)
}
sort(v)
}
(chp <- chisq_plot(df))
rang <- c()
n <- length(chp)
for (i in 1:n){
rang <- c(rang, (i-1/2)/n)
}
(q <- qchisq(rang, 9))
plot(q, chp)
abline(0,1, col = "red")
par(mfrow = c(3, 3))
for (i in 1:9) {
qqnorm(df[,i])
}
dh <- dd[dd$Gender == "male",1:9]
par(mfrow=c(3,3))
for (i in 1:9){
qqnorm(dh[,i])
}
HotellingsT2(df, dh, test = "f")
HotellingsT2(df, dh, test = "chi")
t.test(df$Biacromial, dh$Biacromial, conf.level = 0.999)
t.test(df$Biilical, dh$Biilical, conf.level = 0.999)
t.test(df$Bitrochanteric, dh$Bitrochanteric, conf.level = 0.999)
t.test(df$Chest_depth, dh$Chest_depth, conf.level = 0.999)
t.test(df$Chest_diam, dh$Chest_diam, conf.level = 0.999)
t.test(df$Elbow, dh$Elbow, conf.level = 0.999)
t.test(df$Wrist, dh$Wrist, conf.level = 0.999)
t.test(df$Knee, dh$Knee, conf.level = 0.999)
t.test(df$Ankle, dh$Ankle, conf.level = 0.999)
par(mfrow=c(3,3))
boxplot(dd$Biacromial~dd$Gender)
boxplot(dd$Biilical~dd$Gender)
boxplot(dd$Bitrochanteric~dd$Gender)
boxplot(dd$Chest_depth~dd$Gender)
boxplot(dd$Chest_diam~dd$Gender)
boxplot(dd$Elbow~dd$Gender)
boxplot(dd$Wrist~dd$Gender)
boxplot(dd$Knee~dd$Gender)
boxplot(dd$Ankle~dd$Gender)
WK <- data.frame(dd$Wrist, dd$Knee)
plot(WK, pch = 3, cex = 0.5)
Z <- ellipse(cov(WK), level = 0.95, centre = colMeans(WK))
points(Z, type = "l", col = "red")
dd <- read.table("http://www-eio.upc.es/%7Ejan/Data/MVA/cmc.dat", header = T, sep=',')
attach(dd)
head(dd)
summary(dd)
Age < 5 || Age > 70
WifeEduc!=1 && WifeEduc!=2 && WifeEduc!=3 && WifeEduc!=4
HusbEduc!=1 && HusbEduc!=2 && HusbEduc!=3 && HusbEduc!=4
sum(Childs>4)
sum(Childs==16)
Rel!=0 && Rel!=1
Work!=0 && Work!=1
Occup!=1 && Occup!=2 && Occup!=3 && Occup!=4
Standard!=1 && Standard!=2 && Standard!=3 && Standard!=4
Media!=0 && Media!=1
Method!=1 && Method!=2 && Method!=3
dd[is.na(dd)]
dd$Method[Method==1] <- "3none"
dd$Method[Method==2] <- "1long-term"
dd$Method[Method==3] <- "2short-term"
dd$Method <- as.factor(dd$Method)
dd$WifeEduc[WifeEduc==1] <- "4low"
dd$WifeEduc[WifeEduc==2] <- "3medium-low"
dd$WifeEduc[WifeEduc==3] <- "2medium-high"
dd$WifeEduc[WifeEduc==4] <- "1high"
dd$WifeEduc <- as.factor(dd$WifeEduc)
detach(dd)
attach(dd)
(cont <- table(Method, WifeEduc))
chi.test <- chisq.test(Method, WifeEduc)
chi.test$statistic
chi.test$p.value
# Columna
(c <- apply(cont, 2, sum))
# Fila
(r <- apply(cont, 1, sum))
Dr <- diag(r)
Dc <- diag(c)
(R <- solve(Dr)%*%cont)
(C <- t(solve(Dc)%*%t(cont)))
library(ca)
resultats <- ca(cont)
summary(resultats)
plot(resultats, map="rowprincipal")
dd$Age <- cut(dd$Age, breaks=4)
detach(dd)
attach(dd)
table(Age)
library(tidyr)
dd <- unite(dd, AgeRel, c(Age, Rel), remove=F)
detach(dd)
attach(dd)
table(AgeRel)
(cont2 <- table(AgeRel, Method))
res <- ca(cont2)
plot(res, map="rowgreen")
out <- mjca(dd[,c("WifeEduc", "Method", "AgeRel")], lambda="indicator")
summary(out)
out$inertia.t
plot(out, main="MCA biplot of Indicator matrix")
plot(out, main="MCA biplot of Indicator matrix with data")
points(out$rowpcoord[,1], out$rowpcoord[,2])
dim(out$rowpcoord)
out2 <- mjca(dd[,c("WifeEduc", "Method", "AgeRel")], lambda="Burt")
summary(out2)
plot(out2, main="MCA biplot of Burt matrix with data")
points(out2$rowpcoord[,1], out$rowpcoord[,2])
detach(dd)
esq <- read.table("http://www-eio.upc.es/%7Ejan/Data/MVA/body.dat")
esq <- esq[,c(1:9,25)]
colnames(esq) <- c("Biacromial.diam", "Biiliac.diam", "Bitrochanteric.diam", "Chest.depth", "Chest.diam", "Elbow.diam", "Wrist.diam", "Knee.diam", "Ankle.diam", "Gender")
esq$Gender <- as.factor(esq$Gender)
head(esq)
attach(esq)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
mean.WK <- c(mean(Wrist.diam), mean(Knee.diam))
WK <- data.frame(Wrist.diam, Knee.diam)
cov.WK <- cov(WK)
library(ellipse)
contour.WK <- ellipse(cov.WK, centre=mean.WK)
lines(contour.WK[,1], contour.WK[,2], col = "red")
# Método 1 (Geométrico)
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
lines(contour.WK[,1], contour.WK[,2], col = "red")
library(SIBER)
Z <- pointsToEllipsoid(WK, cov.WK, mean.WK)
inside <- ellipseInOut(Z)
points(WK[inside,], pch=16, col="green", cex=0.5)
# Método 2 (Estadístico)
library(mvtnorm)
limit <- dmvnorm(contour.WK[1,], mean=mean.WK, sigma=cov.WK)
outside <- dmvnorm(WK, mean=mean.WK, sigma=cov.WK) < limit
plot(Wrist.diam, Knee.diam, main="Wrist vs Knee diameter", pch=16, cex=0.5)
lines(contour.WK[,1], contour.WK[,2], col = "red")
points(WK[outside,], pch=16, col="deeppink", cex=0.7)
detach(esq)
library(dplyr)
esq.f <- filter(esq, Gender==0)
esq.f <- esq.f[,-10]
pairs(esq.f)
esq.f.centre <- as.matrix(scale(esq.f, scale=F))
esq.f.cov <- as.matrix(cov(esq.f))
esq.f.cov.inv <- solve(esq.f.cov)
esq.f.dist.sq <- diag((esq.f.centre) %*% esq.f.cov.inv %*% t(esq.f.centre))
(esq.f.dist.sq.ord <- sort(esq.f.dist.sq))
n <- length(esq.f.dist.sq.ord)
p <- dim(esq)[2]-1
rang <- ((1:n)-0.5)/n
(quantils <- qchisq(rang, df=p))
plot(quantils, esq.f.dist.sq.ord, xlab="Theorical quantiles", ylab="Sample quantiles", main="Chi-square plot")
abline(a=0, b=1, col="red")
sample.quantils <- apply(esq.f, 2, sort)
th.quantils <- qnorm(rang)
par(mfrow=c(3,3))
for (i in 1:9){
plot(th.quantils, sample.quantils[,i], xlab="Theorical quantiles", ylab="Sample quantiles", main=paste("Q-Q norm",colnames(esq.f)[i]))
abline(lm(sample.quantils[,i]~th.quantils), col="red")
}
esq.m <- filter(esq, Gender==1)
esq.m <- esq.m[,-10]
esq.m.centre <- as.matrix(scale(esq.m, scale=F))
esq.m.cov <- as.matrix(cov(esq.m))
esq.m.cov.inv <- solve(esq.m.cov)
esq.m.dist.sq <- diag((esq.m.centre) %*% esq.m.cov.inv %*% t(esq.m.centre))
esq.m.dist.sq.ord <- sort(esq.m.dist.sq)
n.m <- length(esq.m.dist.sq.ord)
rang <- ((1:n.m)-0.5)/n.m
(quantils.m <- qchisq(rang, df=p))
plot(quantils.m, esq.m.dist.sq.ord, xlab="Theorical quantiles", ylab="Sample quantiles", main="Chi-square plot (Hombres)")
abline(a=0, b=1, col="red")
library(ICSNP)
(hot.test <- HotellingsT2(esq.f,esq.m,test="f"))
hot.test$statistic
hot.test$p.value
m1 <- colMeans(esq.f)
m2 <- colMeans(esq.m)
S1 <- cov(esq.f)
S2 <- cov(esq.m)
n1 <- dim(esq.f)[1]
n2 <- dim(esq.m)[1]
(T2 <- (m1-m2)%*%solve(S1/50+S2/50)%*%(m1-m2))
qchisq(0.95,2)
for (i in 1:9){
test.marginal <- t.test(esq.f[,i],esq.m[,i], var.equal=F)
if (test.marginal$p.value < 0.001) {
print(paste("Difference in", colnames(esq)[i]))
} else {
print(paste("No difference in", colnames(esq)[i]))
}
}
for (i in 1:9){
boxplot(esq.f[,i], esq.m[,i], names=c("Female","Male"), main=colnames(esq)[i])
}
m1 <- colMeans(esq.f)
m2 <- colMeans(esq.m)
S1 <- cov(esq.f)
S2 <- cov(esq.m)
n1 <- dim(esq.f)[1]
n2 <- dim(esq.m)[1]
(T2 <- (m1-m2)%*%solve(S1/n1+S2/n2)%*%(m1-m2))
qchisq(0.95,2)
